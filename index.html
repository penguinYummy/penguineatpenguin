<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>실시간 채팅 웹사이트</title>
    <style>
        /* 채팅창 디자인 (선택 사항) */
        #messages {
            height: 300px;
            overflow-y: scroll; /* 스크롤바 */
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
            width: 80%;
            max-width: 600px;
        }
        #message-form {
            display: flex;
        }
        #message-input {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #ccc;
        }
        #message-form button {
            padding: 8px 15px;
            background-color: #5cb85c;
            color: white;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <h1>실시간 소통 채팅방 </h1>

    <div id="messages">
        </div>

    <form id="message-form">
        <input type="text" id="message-input" placeholder="메시지를 입력하세요" required>
        <button type="submit">전송</button>
    </form>


    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>


    <script>
         const firebaseConfig = {
    apiKey: "AIzaSyB_nt4nzPfp-trlT8QHNFPFpd-oKqfyWGo",
    authDomain: "penguineatpenguin.firebaseapp.com",
    projectId: "penguineatpenguin",
    storageBucket: "penguineatpenguin.firebasestorage.app",
    messagingSenderId: "757747390049",
    appId: "1:757747390049:web:72bcdc12d5eb3bc1b97c20",
    measurementId: "G-XCT650Z39X"
  };

        

        // Firebase 초기화
        firebase.initializeApp(firebaseConfig);
        
        // Realtime Database 참조 (채팅 메시지를 저장할 공간)
        const messagesRef = firebase.database().ref('messages');
        const form = document.getElementById('message-form');
        const input = document.getElementById('message-input');
        const messagesContainer = document.getElementById('messages');

        // 메시지 전송 처리
        form.addEventListener('submit', (e) => {
            e.preventDefault(); // 페이지 새로고침 방지
            const messageText = input.value;
            
            if (messageText.trim() === '') return;

            // Firebase DB에 새 메시지 저장
            messagesRef.push({
                text: messageText,
                timestamp: Date.now()
            });

            input.value = ''; // 입력 필드 초기화
        });

        // 실시간 메시지 수신 및 표시
        // 'child_added' 이벤트는 새 메시지가 추가될 때마다 실행됩니다.
        messagesRef.on('child_added', (snapshot) => {
            const messageData = snapshot.val();
            const messageElement = document.createElement('p');
            
            // 메시지를 화면에 표시
            messageElement.textContent = messageData.text; 
            messagesContainer.appendChild(messageElement);
            
            // 스크롤을 항상 최신 메시지로 이동
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        });
    </script>

</body>
</html>
